<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON-editor f√∂r kravlistan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <button id="themeToggleButton" aria-live="polite">Byt till m√∂rkt tema</button>
    <h1>JSON-editor f√∂r kravlistan</h1>

    <!-- Container f√∂r initial uppladdningsvy -->
    <div id="contentDisplay" class="content-container">
        <div id="uploadSection">
            <p>Ladda upp din JSON-fil med kravdata f√∂r att b√∂rja.</p>
            <!-- √ÑNDRING H√ÑR: Fr√•n label till button -->
            <button type="button" id="uploadFileButton" class="button-like-styling"> <!-- Nytt ID och ev. ny klass -->
                 Ladda upp JSON-fil... <span class="icon" aria-hidden="true">‚¨ÜÔ∏è</span>
            </button>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
            <p class="field-instruction">Anv√§nd en JSON-fil som f√∂ljer Diggs tillsynsmanuals struktur.</p>
        </div>
    </div>
    
    <!-- Kontroller (utanf√∂r contentDisplay) -->
    <div id="postUploadControlsContainer" class="hidden">
         <div class="main-controls">
            <button id="showMetadataButton">
                Visa metadata <span class="icon" aria-hidden="true">‚ÑπÔ∏è</span>
            </button>
            <button id="showRequirementsButton">
                 Visa alla krav <span class="icon" aria-hidden="true">üìã</span>
            </button>
        </div>
         <div class="secondary-controls">
            <!-- S√∂k- och filterrad (visas bara i kravlistan) -->
            <div id="filterSortRow" class="hidden filter-sort-row">
                 <div id="sortControls">
                     <label for="sortOrderSelect">Sortera:</label>
                     <select id="sortOrderSelect">
                         <option value="category-asc" selected>Kategorier (A-√ñ)</option>
                         <option value="category-desc">Kategorier (√ñ-A)</option>
                         <option value="ref-asc">Krav (Stigande)</option> <!-- √Ñndrad text -->
                         <option value="ref-desc">Krav (Fallande)</option> <!-- √Ñndrad text -->
                         <option value="impact-critical-first">P√•verkan (Kritisk f√∂rst)</option>
                         <option value="impact-critical-last">P√•verkan (Kritisk sist)</option>
                     </select>
                 </div>
                 <div class="search-control">
                    <label for="searchInput" class="visually-hidden">S√∂k krav</label>
                    <input type="search" id="searchInput" placeholder="S√∂k p√• titel, kravnr, text...">
                    <span class="search-icon" aria-hidden="true">üîç</span>
                 </div>
                 <button id="addRequirementButton">
                      L√§gg till krav <span class="icon" aria-hidden="true">‚ûï</span>
                  </button>
            </div>

             <!-- Globala spara-knappen -->
             <button id="saveChangesButton" class="hidden">
                 Spara √§ndringar (JSON) <span class="icon" aria-hidden="true">üíæ</span>
            </button>
            <!-- Plats f√∂r inline save confirmation (l√§ggs till av JS) -->
         </div>
    </div>
    <hr id="controlsDivider" class="hidden">

    <!-- Dynamiskt inneh√•ll -->
    <div id="dynamicContentArea" class="hidden">
        <!-- Inneh√•ll renderas h√§r av JavaScript -->
    </div>

    <!-- Scripts -->

    <!-- 1. FileSaver.js fr√•n CDN med korrekt integrity-hash (h√§mtad 2024-05-07) -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"
        integrity="sha512-Qlv6VSKh1gDKGoJbnyA5RMXYcvnpIqhO++MhIM2fStMcGT9i2T//tSwYFlcyoRRDcDZ+TYHpH8azBBCyhpSeqw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer">
    </script>

    <!-- 2. Ladda huvudapplikationen som en ES-modul -->
    <script type="module" src="js/main.js"></script>

</body>
</html>