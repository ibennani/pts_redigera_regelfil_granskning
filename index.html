<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON-editor f√∂r kravlistan</title>
    
    <!-- Din befintliga CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- START: Till√§gg f√∂r Markdown Toolbar -->
    <!-- 1. Font Awesome f√∂r ikonerna i verktygsraden -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- 2. CSS f√∂r sj√§lva verktygsraden -->
    <link rel="stylesheet" href="css/features/markdown_toolbar.css">
    <!-- SLUT: Till√§gg f√∂r Markdown Toolbar -->

</head>
<body>
    <button id="themeToggleButton" aria-live="polite">Byt till m√∂rkt tema</button>
    <h1>JSON-editor f√∂r kravlistan</h1>

    <!-- Container f√∂r initial uppladdningsvy -->
    <div id="contentDisplay" class="content-container">
        <div id="uploadSection">
            <p>Ladda upp din JSON-fil med kravdata f√∂r att b√∂rja.</p>
            <button type="button" id="uploadFileButton" class="button-like-styling">
                 Ladda upp JSON-fil... <span class="icon" aria-hidden="true">‚¨ÜÔ∏è</span>
            </button>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
            <p class="field-instruction">Anv√§nd en JSON-fil som f√∂ljer Diggs tillsynsmanuals struktur.</p>
        </div>
    </div>
    
    <!-- Kontroller (utanf√∂r contentDisplay) -->
    <div id="postUploadControlsContainer" class="hidden">
         <div class="main-controls">
            <button id="showMetadataButton">
                Visa metadata <span class="icon" aria-hidden="true">‚ÑπÔ∏è</span>
            </button>
            <button id="showRequirementsButton">
                 Visa alla krav <span class="icon" aria-hidden="true">üìã</span>
            </button>
        </div>
         <div class="secondary-controls">
            <div id="filterSortRow" class="hidden filter-sort-row">
                 <div id="sortControls">
                     <label for="sortOrderSelect">Sortera:</label>
                     <select id="sortOrderSelect">
                         <option value="category-asc">Kategorier (A-√ñ)</option>
                         <option value="category-desc">Kategorier (√ñ-A)</option>
                         <option value="ref-asc" selected>Krav (Stigande)</option>
                         <option value="ref-desc">Krav (Fallande)</option>
                         <option value="impact-critical-first">P√•verkan (Kritisk f√∂rst)</option>
                         <option value="impact-critical-last">P√•verkan (Kritisk sist)</option>
                     </select>
                 </div>
                 <div class="search-control">
                    <label for="searchInput" class="visually-hidden">S√∂k krav</label>
                    <input type="search" id="searchInput" placeholder="S√∂k p√• titel, kravnr, text...">
                    <span class="search-icon" aria-hidden="true">üîç</span>
                 </div>
                 <button id="addRequirementButton">
                      L√§gg till krav <span class="icon" aria-hidden="true">‚ûï</span>
                  </button>
            </div>
             <button id="saveChangesButton" class="hidden">
                 Spara √§ndringar (JSON) <span class="icon" aria-hidden="true">üíæ</span>
            </button>
         </div>
    </div>
    <hr id="controlsDivider" class="hidden">

    <!-- Dynamiskt inneh√•ll -->
    <div id="dynamicContentArea" class="hidden">
        <!-- Inneh√•ll renderas h√§r av JavaScript.
             N√§r textrutor skapas h√§r kommer verktygsraden automatiskt att l√§ggas till. -->
    </div>

    <!-- Scripts -->

    <!-- Befintligt skript f√∂r FileSaver.js -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"
        integrity="sha512-Qlv6VSKh1gDKGoJbnyA5RMXYcvnpIqhO++MhIM2fStMcGT9i2T//tSwYFlcyoRRDcDZ+TYHpH8azBBCyhpSeqw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer">
    </script>

    <!-- START: Till√§gg f√∂r Markdown Toolbar -->
    <!-- 1. Beroende: Marked.js (f√∂r att rendera f√∂rhandsgranskning) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- 2. Dina nya skript-filer -->
    <script src="js/helpers.js"></script>
    <script src="js/features/markdown_toolbar.js"></script>
    <!-- SLUT: Till√§gg f√∂r Markdown Toolbar -->

    <!-- Ditt befintliga huvudskript f√∂r applikationen -->
    <script type="module" src="js/main.js"></script>
    
    <!-- START: Till√§gg f√∂r Markdown Toolbar -->
    <!-- 3. Initiera (starta) Markdown-verktygsraden n√§r sidan har laddats -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Kontrollerar att funktionen finns innan den anropas
            if (window.MarkdownToolbar && typeof window.MarkdownToolbar.init === 'function') {
                window.MarkdownToolbar.init();
            } else {
                console.error('MarkdownToolbar kunde inte initieras. Kontrollera att markdown_toolbar.js √§r korrekt inladdad.');
            }
        });
    </script>
    <!-- SLUT: Till√§gg f√∂r Markdown Toolbar -->

</body>
</html>