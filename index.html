<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON-editor fÃ¶r kravlistan</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>JSON-editor fÃ¶r kravlistan</h1>

    <!-- Container fÃ¶r initial uppladdningsvy -->
    <div id="contentDisplay" class="content-container">
        <div id="uploadSection">
            <p>Ladda upp din JSON-fil med kravdata fÃ¶r att bÃ¶rja.</p>
            <label for="fileInput" class="button-like-label">
                 <span class="icon" aria-hidden="true">â¬†ï¸</span> Ladda upp JSON-fil...
            </label>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
            <p class="field-instruction">AnvÃ¤nd en JSON-fil som fÃ¶ljer Diggs tillsynsmanuals struktur.</p>
        </div>
    </div>

    <!-- Kontroller (utanfÃ¶r contentDisplay) -->
    <div id="postUploadControlsContainer" class="hidden">
         <div class="main-controls">
            <button id="showMetadataButton">
                <span class="icon" aria-hidden="true">â„¹ï¸</span> Visa metadata
            </button>
            <button id="showRequirementsButton">
                 <span class="icon" aria-hidden="true">ğŸ“‹</span> Visa kontroller
            </button>
        </div>
         <div class="secondary-controls">
            <!-- SÃ¶k- och filterrad (visas bara i kravlistan) -->
            <div id="filterSortRow" class="hidden filter-sort-row">
                 <div id="sortControls">
                     <label for="sortOrderSelect">Sortera:</label>
                     <select id="sortOrderSelect">
                         <option value="category-asc" selected>Kategorier (A-Ã–)</option>
                         <option value="category-desc">Kategorier (Ã–-A)</option>
                         <option value="ref-asc">Referens (Stigande)</option>
                         <option value="ref-desc">Referens (Fallande)</option>
                         <option value="impact-critical-first">PÃ¥verkan (Kritisk fÃ¶rst)</option>
                         <option value="impact-critical-last">PÃ¥verkan (Kritisk sist)</option>
                     </select>
                 </div>
                 <div class="search-control">
                    <label for="searchInput" class="visually-hidden">SÃ¶k krav</label>
                    <input type="search" id="searchInput" placeholder="SÃ¶k pÃ¥ titel, ref, text...">
                    <span class="search-icon" aria-hidden="true">ğŸ”</span>
                 </div>
                 <button id="addRequirementButton">
                      <span class="icon" aria-hidden="true">â•</span> LÃ¤gg till krav
                  </button>
            </div>

             <!-- Globala spara-knappen -->
             <button id="saveChangesButton" class="hidden">
                 <span class="icon" aria-hidden="true">ğŸ’¾</span> Spara Ã¤ndringar (JSON)
            </button>
            <!-- Plats fÃ¶r inline save confirmation (lÃ¤ggs till av JS) -->
         </div>
    </div>
    <hr id="controlsDivider" class="hidden">

    <!-- Dynamiskt innehÃ¥ll -->
    <div id="dynamicContentArea" class="hidden">
        <!-- InnehÃ¥ll renderas hÃ¤r av JavaScript -->
    </div>

    <!-- Scripts -->

    <!-- 1. FileSaver.js frÃ¥n CDN med korrekt integrity-hash (hÃ¤mtad 2024-05-07) -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"
        integrity="sha512-Qlv6VSKh1gDKGoJbnyA5RMXYcvnpIqhO++MhIM2fStMcGT9i2T//tSwYFlcyoRRDcDZ+TYHpH8azBBCyhpSeqw=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer">
    </script>

    <!-- 2. Ladda huvudapplikationen som en ES-modul -->
    <script type="module" src="js/main.js"></script>

</body>
</html>
